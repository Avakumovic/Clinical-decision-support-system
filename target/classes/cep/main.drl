package ljubisa

import ljubisa.model.*;
import java.util.Set
import java.util.List
import javax.swing.JTextArea;

global Bolest prehlada;
global Bolest groznica;
global Bolest upalaKrajnika;
global Bolest sinusnaInfekcija;
global Bolest dijabetes;
global Bolest hipertenzija;
global Bolest hronicnaBubreznaBolest;
global Bolest akutnaBubreznaBolest;

query issimptomContainedInBolest (SviSimptomi sim, Bolest bol)
	BolestSimptomLink ( sim, bol; )
end

rule "prikazi Specificne simp neke bolesti"
salience 300
agenda-group "prikaziSimptomeNekeBolesti"
	when
		$text : JTextArea(   )
		$bolest : Bolest($simSpec : specificniSimptomi != null)
	then
		$text.setText($text.getText() + "Specificni simptomi " + $simSpec + "\n");
end

rule "prikazi sim neke bole"
salience 200
agenda-group "prikaziSimptomeNekeBolesti"
	when
		$text : JTextArea(  )	
		$bolest : Bolest($sim : sviSimptomi)
	then
	 	$text.setText($text.getText()+"Simptomi: " +$sim+ "\n");
end

rule	"prehlada"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled(  )
		$text:JTextArea()
		$s:Set(size>0) from collect(SviSimptomi( this memberOf prehlada.getSviSimptomi()))
	then
		$text.setText($text.getText() + "prehlada " +$s.size()+"\n");
end

rule	"groznica"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled()
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf groznica.getSviSimptomi()))
		
	then
		$text.setText($text.getText()+"groznica " +$s.size()+"\n");
end

rule	"upalaKrajnika"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled()
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf upalaKrajnika.getSviSimptomi()))
	then
		$text.setText($text.getText()+"upalaKrajnika " +$s.size()+"\n");
end

rule	"sinusnaInfekcija"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled(  )
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf sinusnaInfekcija.getSviSimptomi()))
	then
		$text.setText($text.getText()+"sinusnaIinfekcija " +$s.size()+"\n");
end

rule	"dijabetes"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled(  )
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf dijabetes.getSviSimptomi()))
	then
		$text.setText($text.getText()+"dijabetes " +$s.size()+"\n");
end

rule	"hipertenzija"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled(  )
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf hipertenzija.getSviSimptomi()))
	then
		$text.setText($text.getText()+"hipertenzija " +$s.size()+"\n");
end

rule	"hronicnaBubreznaBolest"
agenda-group "SimpUBolestima"
salience $s.size()
	when
		Pregled()
		$text:JTextArea(  )
		$s:Set(size>0) from collect(SviSimptomi( this memberOf hronicnaBubreznaBolest.getSviSimptomi()))
	then
		$text.setText($text.getText()+"hronicnaBubreznaBolest " +$s.size()+"\n");	
end

rule	"akutnaBubreznaBolest"
agenda-group "SimpUBolestima"
salience $s.size()+$sss.size()
	when
		Pregled(  )
		$text:JTextArea()
		$s:Set() from collect(SviSimptomi( this memberOf akutnaBubreznaBolest.getSviSimptomi()))
		$sss:Set() from collect(SpecificniSimptomi())  
		eval($s.size()+$sss.size()>0)
	then
		int i = ($s.size()+$sss.size());
		$text.setText($text.getText()+"akutnaBubreznaBolest " +i+"\n");
end

rule	"veca od 38"
agenda-group "SimpUBolestima"
salience -800
no-loop
lock-on-active
	when
		$text:JTextArea(  )
		$pr:Pregled(temperatura > 38)
	then
	 	insert(SviSimptomi.TEMPERATURA_VECA_OD_38); 
		$text.setText("");
		update($pr);
end

rule	"izmedju 40 i  41"
agenda-group "SimpUBolestima"
salience -800
no-loop
lock-on-active
	when
		$text:JTextArea(  )
		$pr:Pregled( $temp :temperatura )
		eval($temp>40.0)
		eval($temp<41.0)
	then
	 	insert(SviSimptomi.TEMPERATURA_IZMEDJU_40_I_41); 
		$text.setText("");
		update($pr);
end

rule "obrishi ta"
salience -10
	when
		$text:JTextArea(  )
	then
		delete($text);
end

rule "obrishi selektovanu bolest"
salience -10
	when
		$b:Bolest()
	then
		delete($b);
end

rule "obrishi simptome"
salience -10
when
	$s:SviSimptomi()
then
	delete($s);
end

rule "obrishi specificne simptome "
salience -10
when
	$sss:SpecificniSimptomi()
then
	delete($sss);
end

rule "obrishi Pregled"
salience -11
when
	$pr: Pregled()
then
	delete($pr);
end